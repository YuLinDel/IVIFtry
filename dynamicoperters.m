%区间直觉模糊数排序
%
%输入
%输出
%

clear 
clc

%输入历史值
A=[0.695606013136973,0.829299523801547,0.0401791091312290,0.170700476198453;0.528685137989390,0.667750652084252,0.200000000000000,0.300000000000000;0.436379507180092,0.567434490670357,0.170853157833060,0.304612854313966;0.628683469472867,0.768052420662681,0.0620642251830872,0.162210943692605;0.533411669454615,0.666412323770711,0.131439172643179,0.295879818666060;0.289580702116703,0.452496420431417,0.404949826295618,0.506006713874593;0.304911720760191,0.553737111689988,0.271059376187914,0.414598104806734];
B=[0.737372036170598,0.868409025462490,0.0314578755011953,0.131590974537510;0.501848926011157,0.632214350426146,0.131522875073950,0.303996435881286;0.335460316531735,0.528347336461041,0.165876841134947,0.331888401789161;0.603112076666425,0.737603284857336,0.100000000000000,0.231715685009180;0.467272623586320,0.668018269064819,0.162442629009314,0.300000000000000;0.279308180166876,0.427865833348997,0.441221544621601,0.572134166651003;0.366450009212518,0.536942877033971,0.270950121511900,0.432403553375831];
C=[0.696107070685921,0.833889559714415,0.0314791264242009,0.166110440285585;0.493793684217367,0.667750652084252,0.100000000000000,0.232026592008962;0.289580702116703,0.530205224636773,0.200000000000000,0.332354866418324;0.622596602302668,0.804415855265312,0.0652386501748130,0.165849611080266;0.483738316666251,0.584921811802364,0.161932077993964,0.262118363649533;0.265170621879419,0.452702563844936,0.341634203705713,0.469658756241161;0.385813638179496,0.498108181060515,0.289313323468967,0.390910910993575];
%加入时间权重

 wt=[1/6,2/6,3/6];
% % wt=[1/3,1/3,1/3];
% % wt=[0.438,0.323,0.238];
% wt=[0,0,1];

DD=[A B C];
R=mat2cell(DD,[1,1,1,1,1,1,1],[4,4,4]);%直接存成了cell型
A=7;
G=3;
for l=1:A
D=zeros(G,G);
a1=0;a2=0;b1=0;b2=0;c1=0;c2=0;d1=0;d2=0;
for i=1:G
    m=R{l,i};
    a1=m(1);
    b1=m(2);
    c1=m(3);
    d1=m(4);
    for j=1:G
        if j==i
            continue
        end
        n=R{l,j};
        a2=n(1);
        b2=n(2);
        c2=n(3);
        d2=n(4);
        D(i,j)=0.25*(abs(a1-a2)+abs(b1-b2)+abs(c1-c2)+abs(d1-d2)+abs(b2-b1-d1+d2)+abs(a2+c2-a1-c1));
    end
end

%%求静态集结值
sum_sup=sum(D,2)';
T=zeros(G,G);
sum_e=zeros(1,G);
zs=zeros(1,G);
for i=1:G
    for j=1:G
        if j==i
            continue
        end
        T(i,j)=wt(j)*(1-(D(i,j)/sum_sup(i)));
        T_a=sum(T,2)';
        sum_e(i)=wt(i)*(1+T_a(i));
        sum_zs=sum(sum_e);
    end
%     zs(i)=sum_e(i)/sum_zs;
end
% IIFPWGA=zeros(A,G);
a_e=zeros(1,G);
b_e=zeros(1,G);
c_e=zeros(1,G);
d_e=zeros(1,G);
IA1=1;
IA2=1;
IA3=1;
IA4=1;
for i=1:G
    zs(i)=sum_e(i)/sum_zs;
    a_e(i)=DD(l,(i-1)*4+1)^zs(i);
    IA1=IA1*a_e(i);
    b_e(i)=DD(l,(i-1)*4+2)^zs(i);
    IA2=IA2*b_e(i);
    c_e(i)=(1-DD(l,(i-1)*4+3))^zs(i);
    IA3=IA3*c_e(i);
    d_e(i)=(1-DD(l,(i-1)*4+4))^zs(i);
    IA4=IA4*d_e(i);
end
IIFPWGA(l,:)={IA1,IA2,(1-IA3),(1-IA4)};
end

IIFP=cell2mat(IIFPWGA);
for i=1:A
    S(i)=(IIFP(i,1)+IIFP(i,2)-IIFP(i,3)-IIFP(i,4))/2;
    H(i)=(IIFP(i,1)+IIFP(i,2)+IIFP(i,3)+IIFP(i,4))/2;
end


