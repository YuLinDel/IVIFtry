%区间直觉模糊数排序
%
%输入
%输出
%

clear 
clc

%输入历史值
A=[0.283936980844450,0.402150024573128,0.466129294814545,0.577494428447386;
    0.551963376744295,0.657527404919854,0.205032837581872,0.306692379746238;
    0.485881162512182,0.586838414408201,0.257524548503270,0.357776964258364;
    0.372094595553485,0.485538552627419,0.318738519290149,0.422232948863619;
    0.474097924812266,0.578893790954301,0.260859455970073,0.342684814616152];
B=[0,0.268988924141162,0.402193409020259,0.528123188652694;
    0.490085397431525,0.593632676948717,0.159658839406762,0.262304353081237;
    0.404866412172860,0.506911111351632,0.192898470855993,0.293582453944247;
    0.306503493207882,0.429551835955598,0.237445652021979,0.341848545738913;
    0.417445137921544,0.534644732449587,0.139370246710546,0.239815649801712];
C=[0,0.268869288514227,0.615309804239121,0.707838997701062;
    0.487525675921129,0.572373781641014,0.325646369897917,0.427626218358986;
    0.421677137228751,0.495065030014967,0.394036692813137,0.457993646880085;
    0.306174941952588,0.429211545976122,0.421980500502788,0.498604556987050;
    0.366103452629616,0.474010630862657,0.298798924769340,0.421186221914216];

%加入时间权重

wt=[0.238,0.323,0.438];


DD=[A B C];
R=mat2cell(DD,[1,1,1,1,1],[4,4,4]);%直接存成了cell型
A=5;
G=3;
for l=1:A
D=zeros(G,G);
a1=0;a2=0;b1=0;b2=0;c1=0;c2=0;d1=0;d2=0;
for i=1:G
    m=R{l,i};
    a1=m(1);
    b1=m(2);
    c1=m(3);
    d1=m(4);
    for j=1:G
        if j==i
            continue
        end
        n=R{l,j};
        a2=n(1);
        b2=n(2);
        c2=n(3);
        d2=n(4);
        D(i,j)=0.25*(abs(a1-a2)+abs(b1-b2)+abs(c1-c2)+abs(d1-d2));
    end
end

%%求静态集结值
sum_sup=sum(D,2)';
T=zeros(G,G);
sum_e=zeros(1,G);
zs=zeros(1,G);
for i=1:G
    for j=1:G
        if j==i
            continue
        end
        T(i,j)=wt(j)*(1-(D(i,j)/sum_sup(i)));
        T_a=sum(T,2)';
        sum_e(i)=wt(i)*(1+T_a(i));
        sum_zs=sum(sum_e);
    end
%     zs(i)=sum_e(i)/sum_zs;
end
% IIFPWGA=zeros(A,G);
a_e=zeros(1,G);
b_e=zeros(1,G);
c_e=zeros(1,G);
d_e=zeros(1,G);
IA1=1;
IA2=1;
IA3=1;
IA4=1;
for i=1:G
    zs(i)=sum_e(i)/sum_zs;
    a_e(i)=DD(l,(i-1)*4+1)^zs(i);
    IA1=IA1*a_e(i);
    b_e(i)=DD(l,(i-1)*4+2)^zs(i);
    IA2=IA2*b_e(i);
    c_e(i)=(1-DD(l,(i-1)*4+3))^zs(i);
    IA3=IA3*c_e(i);
    d_e(i)=(1-DD(l,(i-1)*4+4))^zs(i);
    IA4=IA4*d_e(i);
end
IIFPWGA(l,:)={IA1,IA2,(1-IA3),(1-IA4)};
end

IIFP=cell2mat(IIFPWGA);
for i=1:A
    S(i)=(IIFP(i,1)+IIFP(i,2)-IIFP(i,3)-IIFP(i,4))/2;
    H(i)=(IIFP(i,1)+IIFP(i,2)+IIFP(i,3)+IIFP(i,4))/2;
end


